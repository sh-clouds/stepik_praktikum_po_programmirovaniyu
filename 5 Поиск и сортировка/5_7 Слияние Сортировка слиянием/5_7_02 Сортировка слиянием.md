Сортировка слиянием

Отсортируйте данный массив, используя сортировку слиянием.
Входные данные

Первая строка входных данных содержит количество элементов в массиве N, N ≤ 105. Далее идет N целых чисел, не превосходящих по абсолютной величине 109.

Выходные данные
Выведите эти числа в порядке неубывания.

Sample Input:
2
3 1

Sample Output:
1 3

Напишите программу. Тестируется через stdin → stdout
Верно решил 161 учащийся
Из всех попыток 70% верных


# ruby
def bose_nelson(data)
    m = 1
    while m < data.size
        j = 0
        while j + m < data.size
            data = bose_nelson_merge(j, m, m, data)
            j = j + m + m
        end    
        m = m + m
    end         
    return data
end    
   

def bose_nelson_merge(j, r, m, data)
    if j + r < data.size
        if m == 1
            if data[j] > data[j + r]
                data[j], data[j + r] = data[j + r], data[j]
            end    
        else
            m = m / 2
            data = bose_nelson_merge(j, r, m, data)
            if j + r + m < data.size
                data = bose_nelson_merge(j + m, r, m, data)
            end    
            data = bose_nelson_merge(j + m, r - m, m, data)
        end
    end    
    return data
end    

x = gets.to_i
lst = gets.chomp.split().map{|j| j.to_i}
lst = bose_nelson(lst)
print lst.join(" ")



# python
def bose_nelson(data):
    m = 1
    while m < len(data):
        j = 0
        while j + m < len(data):
            bose_nelson_merge(j, m, m, data)
            j = j + m + m
        m = m + m
    return data

def bose_nelson_merge(j, r, m, data):
    if j + r < len(data):
        if m == 1:
            if data[j] > data[j + r]:
                data[j], data[j + r] = data[j + r], data[j]
        else:
            m = m // 2
            bose_nelson_merge(j, r, m, data)
            if j + r + m < len(data):
                bose_nelson_merge(j + m, r, m, data)
            bose_nelson_merge(j + m, r - m, m, data)
    return data

n=int(input())
lst = list(map(int, input().split()))
lst = bose_nelson(lst)
print (*lst)


# java
import java.util.Scanner;
import java.util.stream.IntStream;

public class Main {
    public static void main(String[] args) {
        Scanner input = new Scanner(System.in);
        int number = Integer.parseInt(input.nextLine());
        int[] array = IntStream.generate(input::nextInt).limit(number).toArray();
        mergeSort(array, 0, array.length -1);
        printTheArray(array);
    }

    private static void mergeSort(int[] array, int left, int right) {
        if (left < right) {
            int middlePoint = (left + right) / 2;

            mergeSort(array, left, middlePoint);
            mergeSort(array, middlePoint + 1, right);
            merge(array, left, middlePoint, right);
        }
    }

    private static void merge(int[] array, int left, int middlePoint, int right) {
        int size1 = middlePoint - left + 1;
        int size2 = right - middlePoint;

        int[] theFirst = new int[size1];
        int[] theSecond = new int[size2];

        for (int a = 0; a < size1; ++a) {
            theFirst[a] = array[left + a];
        }

        for (int b = 0; b < size2; ++b) {
            theSecond[b] = array[middlePoint + 1 + b];
        }

        int e = 0, f = 0, u = left;

        while (e < size1 && f < size2) {
            if (theFirst[e] <= theSecond[f]) {
                array[u] = theFirst[e];
                e++;
            }
            else {
                array[u] = theSecond[f];
                f++;
            }
            u++;
        }

        while (e < size1) {
            array[u] = theFirst[e];
            e++;
            u++;
        }
        
        while (f < size2) {
            array[u] = theSecond[f];
            f++;
            u++;
        }
    }

    private static void printTheArray(int[] array) {
        for (int p = 0; p < array.length; p++) {
            if (p < array.length - 1) System.out.print(array[p] + " ");
            else System.out.println(array[p]);
        }
    }
}


# C++
#include <iostream>
#include <vector>
using namespace std;

void MergeSorting(vector<int>& arr, int start, int end) {
    int mid;
    if (start < end) {
        mid = (start + end) / 2;
        MergeSorting(arr, start, mid);
        MergeSorting(arr, mid + 1, end);

        vector<int> sortArr(arr.size());
        int i = start;
        int j = mid + 1;
        int k = start;

        while (i <= mid && j <= end) {
            if (arr[i] < arr[j]) sortArr[k++] = arr[i++];
            else sortArr[k++] = arr[j++];
        }

        while (i <= mid) sortArr[k++] = arr[i++];
        while (j <= end) sortArr[k++] = arr[j++];

        for (int i = start; i < k; i++) arr[i] = sortArr[i];
    }
}

int main() {
    int N; cin >> N;
    vector<int> arr(N);
    for (int i = 0; i < N; i++) cin >> arr[i];
    MergeSorting(arr, 0, N - 1);

    for (int i = 0; i < N; i++) cout << arr[i] << " ";
    return 0;
}

