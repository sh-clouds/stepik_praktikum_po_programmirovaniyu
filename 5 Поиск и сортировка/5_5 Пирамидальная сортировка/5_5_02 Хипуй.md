Хипуй!

В этой задаче вам необходимо организовать структуру данных Heap для хранения целых чисел, над которой определены следующие операции:

   a) Insert(k) – добавить в Heap число k (1 ≤  k ≤ 1000000) ;
   b) Extract достать из Heap наибольшее число (удалив его при этом).

Входные данные
В первой строке содержится количество команд N (1 ≤  N ≤ 100000), далее следуют N команд, каждая в своей строке.  Команда может иметь  формат: “0 <число>” или “1”, обозначающий, соответственно, операции Insert(<число>) и Extract. Гарантируется, что при выполенении команды Extract в структуре находится по крайней мере один элемент.

Выходные данные
Для каждой команды извлечения необходимо отдельной строкой вывести число, полученное при выполнении команды Extract.

Sample Input:
2
0 10000
1

Sample Output:
10000

Напишите программу. Тестируется через stdin → stdout
Верно решили 108 учащихся
Из всех попыток 73% верных


# ruby
def tbot(m, i, n)  
    if (l = 2 * (im = i) + 1) < n and m[l] > m[im] 
        im = l
    end   

    if (r = 2 * i + 2) < n and m[r] > m[im]
        im = r
    end
    
    if i != im
        m[i], m[im] = m[im], m[i]
        tbot(m, im, n)
    end
end    
  
def tbot_sort (m)
    n = m.size
    
    (n-2).downto(0) do |i|
        tbot(m, i, n)   
    end

    (n-1).downto(1) do |i|
        m[0], m[i] = m[i], m[0]
        tbot(m, 0, i)
    end 
end
    
n = gets.to_i   
m = []

0.upto(n-1) do |i|
    a = gets.chomp.split().map{|j| j.to_i}
    if a.size == 1 # cmd "EXTRACT"      
        tbot_sort(m)
        print "#{m.pop}\n"        
    else # cmd "INSERT"
        m.push(a[1])
    end
end


# python
def insert(k: int):
    m.append(k) 
    ttop(len(m)-1)

def extract():
    ex, m[0] = m[0], m[-1]
    m.pop()
    tbot(0, len(m))
    return ex

def ttop(i: int):  
    if (t := (i - 1) // 2) >= 0 and m[t] < m[i]:
        m[t], m[i] = m[i], m[t]
        ttop(t)

def tbot(i: int, n: int):  
    if (l := 2 * (im := i) + 1) < n and m[l] > m[im]: im = l
    if (r := 2 * i + 2) < n and m[r] > m[im]: im = r
    if i != im:
        m[i], m[im] = m[im], m[i]
        tbot(im, n)

m = []
for _ in range(int(input())):
    match (z := input().split())[0]:
        case '0': insert(int(z[1]))
        case '1': print(extract())


# java
import java.util.Arrays;
import java.util.PriorityQueue;
import java.util.Scanner;
import java.util.Comparator;

public class Main {
    public static void main(String[] args) {
        Scanner input = new Scanner(System.in);
        int number = Integer.parseInt(input.nextLine());

        Heap heap = new Heap();

        for(int a = 0; a < number; a++) {
            int[] data = Arrays.stream(input.nextLine().split("\\s+")).mapToInt(Integer::parseInt).toArray();
            try {
                switch (data[0]) {
                    case 0: heap.insert(data[1]); break;
                    case 1: System.out.println(heap.extract()); break;
                    default: break;
                }
            } catch (NullPointerException ignored) {
            } catch (ArrayIndexOutOfBoundsException ignored) {
            }
        }
    }
}

class Heap {
    private PriorityQueue<Integer> prQueue = new PriorityQueue<>(Comparator.reverseOrder());

    public void insert(int number) {
        prQueue.offer(number);
    }

    public int extract() {
        return prQueue.poll();
    }
}


# C#
using System;
using System.Collections;
using System.Linq;

namespace STEPIK_C_SHARP
{
    class MainProgram
    {
        static ArrayList list = new ArrayList();

        public static void Insert(int number)
        {
            list.Add(number);
        }

        public static int Extract()
        {
            int index = 0; 
            int max = Convert.ToInt32(list[0]);

            for (int i = 0; i < list.Count; i++)
            {
                if ((int)list[i] > max)
                {
                    index = i;
                    max = (int)list[i];
                }
            }

            list.RemoveAt(index);
            return max;
        }

        public static void Main()
        {
            int n = Convert.ToInt32(Console.ReadLine());

            int command = 0, number = 0;

            for (int i = 0; i < n; i++)
            {
                string[] temp = Console.ReadLine().Split();
                if (temp.Length == 2)
                {
                    command = Convert.ToInt32(temp[0]);
                    number = Convert.ToInt32(temp[1]);
                }
                else
                {
                    command = Convert.ToInt32(temp[0]);
                }

                if (command == 0)
                    Insert(number);
                else if (command == 1)
                    Console.WriteLine(Extract());
            }
        }
    }
}


# C++
#include <iostream>

class Heap {
public:
    void Insert(int n) {
        int *copy = new int[size];
        for (int i = 0; i < size; i++) {
            copy[i] = list[i];
        }
        
        delete [] list;
        list = new int[size + 1];
        
        for (int i = 0; i < size; i++) {
            list[i] = copy[i];
        }
        list[size] = n;
        size++;
        delete [] copy;
    }
    int Extract() {
        if (size == 0) {
            throw std::logic_error("Heap is empty");
        }
        
        int max = list[0], max_i = 0;
        int *copy = new int[size];
        for (int i = 0; i < size; i++) {
            if (list[i] > max) {
                max = list[i];
                max_i = i;
            }
            copy[i] = list[i];
        }
        
        delete [] list;
        list = new int[size - 1];
        
        for (int i = 0; i < max_i; i++) {
            list[i] = copy[i];
        }
        for (int i = max_i + 1; i < size; i++) {
            list[i - 1] = copy[i];
        }
        
        size--;
        delete [] copy;
        
        return max;
    }
    Heap() {
        list = new int[size];
    }
    ~Heap() {
        delete [] list;
    }
private:
    int *list;
    int size = 0;
};

int main() {
    int n;
    std::cin >> n;
    Heap heap;
    while (n--) {
        int m;
        std::cin >> m;
        if (m == 0) {
            int v;
            std::cin >> v;
            heap.Insert(v);
        } else if (m == 1) {
            std::cout << heap.Extract() << "\n";
        }
    }
    return 0;
}



